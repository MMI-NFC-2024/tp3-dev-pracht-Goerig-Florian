---
import PlotFigure from "./PlotFigure.astro";
import * as Plot from "@observablehq/plot";
import penguins from "../assets/penguins.json";

interface Props {
  species: string;
  title?: string;
  xKey?: string;
  yKey?: string;
  colorBy?: string;
}

const {
  species,
  title = species,
  xKey = "culmen_length_mm",
  yKey = "culmen_depth_mm",
  colorBy = "sex",
} = Astro.props as Props;

const data = penguins.filter((d) => d.species === species);

const options = {
  marginLeft: 48,
  marginBottom: 48,
  grid: true,
  x: { label: xKey },
  y: { label: yKey },
  color: { legend: true },
  marks: [
    Plot.dot(
      data.filter((d) => d[xKey] != null && d[yKey] != null),
      { x: xKey, y: yKey, stroke: colorBy, r: 3 }
    ),
  ],
};
---

<section>
  {title && <h2 class="text-xl font-bold mb-2">{title}</h2>}
  <div class="bg-white border border-gray-200 rounded-xl p-4 shadow-sm">
    <PlotFigure options={options} />
  </div>
</section>
